<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <%- include('../partials/header',{h1:h1}) %>

    <form action="/productos/<%= producto.id %>?_method=PUT" method="POST">
        <div>
            <label for="nombre"> Nombre:</label>
            <input  type="text"
                    id="nombre"
                    name="nombre"
                    value="<%= typeof old !== 'undefined' ? old.nombre :  producto.nombre %>"    
            >
        </div>
        <div>
            <label for="precio">Precio:</label>
            <input  type="number"
                    id="precio"
                    name="precio"
                    value="<%= typeof old !== 'undefined' ? old.precio :  producto.precio %>"
            >
        </div>
        <div>
            <label for="descripcion">Descripcion:</label>
            <textarea name="descripcion" id="descripcion" > <%= typeof old !== 'undefined' ? old.descripcion :  producto.descripcion %></textarea>
        </div>
        <div>
            <label for="usuario_id">Due√±o</label>
            <select name="usuario_id" id="usuario_id">                
                <% usuarios.forEach(usuario => { %>
                    <option value="<%= usuario.id %>"
                        <%= (typeof old !== 'undefined' ? old.usuario_id :  producto.usuario_id) == usuario.id ? 'selected': '' %>
                    >
                        <%= usuario.nombre %>
                    </option>
                <% }) %>
            </select>
        </div>
        <div>
            <label for="usuario_id">Categorias</label>
            <%  let categoriasActuales = producto.categorias ? producto.categorias.map(cat => cat.id) : [] %>
            <% categorias.forEach(categoria => { %>
                <div>
                    <input  type="checkbox"
                            id="cat_<%=categoria.id%>"
                            name="categorias"
                            value="<%= categoria.id %>"
                            <%= categoriasActuales.includes(categoria.id) ? 'checked' : '' %>
                    >
                    <label for="cat_<%=categoria.id%>"><%= categoria.nombre %></label>
                </div>
            <% }) %>
        </div>
              <button type="submit"> Editar Producto</button>
        <a href="/productos">cancelar</a>

    
    </form>
</body>
</html>